jQuery(document).ready(function(t){var a,e=t(".ywcwat-collapse"),i=null,n=null,o=null,c=null;e.each(function(){t(this).toggleClass("expand").nextUntil("tr.ywcwat-collapse").slideToggle(100)}),t(document).on("click",".ywcwat-collapse",function(){t(this).toggleClass("expand").nextUntil("tr.ywcwat-collapse").slideToggle(100)});var w=function(t){var a=t.parents(".ywcwat_row").attr("id");return a},l=function(t){var a=t.find(".ywcwat_url").val();return a},r=function(t){var a=t.find(".ywcwat_text_wat"),e=t.find(".ywcwat_font_size"),i=t.find(".ywcwat_font_color"),n=t.find(".ywcwat_bg_color"),o=t.find(".ywcwat_opacity"),c=t.find(".ywcwat_box_width"),w=t.find(".ywcwat_box_height"),l=t.find(".ywcwat_line_height"),r=t.find(".ywcwat_watermark_font"),_=t.find(".ywcwat_text_angle"),s="rgba("+m(n.val())+","+d(n.val())+","+u(n.val())+","+o.val()/100+")",p={font_name:t.find(".ywcwat_watermark_font option:selected").text(),font_file_name:r.val(),font_size:e.val(),color_wat:i.val(),background_wat:s,width_box:c.val(),height_box:w.val(),text_wat:a.val(),line_height:l.val(),angle:_.val()};return p},_=function(t){var a,e,i=t.find(".ywcwat_preview_bg"),n=t.find(".ywcwat_sizeselect"),o=t.find(".ywcwat_full_width").val(),c=t.find(".ywcwat_full_height").val();switch(n.val()){case"shop_single":a=""==ywcwat_premium.shop_single.width?"auto":ywcwat_premium.shop_single.width+"px",e=""==ywcwat_premium.shop_single.height?"auto":ywcwat_premium.shop_single.height+"px";break;case"shop_catalog":a=""==ywcwat_premium.shop_catalog.width?"auto":ywcwat_premium.shop_catalog.width+"px",e=""==ywcwat_premium.shop_single.height?"auto":ywcwat_premium.shop_catalog.height;break;case"shop_thumbnail":a=""==ywcwat_premium.shop_thumbnail.width?"auto":ywcwat_premium.shop_thumbnail.width+"px",e=""==ywcwat_premium.shop_thumbnail.height?"auto":ywcwat_premium.shop_thumbnail.height+"px";break;case"full":a=o,e=c}i.css({width:a,height:e})},s=function(a){var e=t("#"+w(a)),i=e.find(".ywcwat_select_type_wat").val(),n=e.find(".ywcwat_preview_watermark"),o=e.find(".ywcwat_settings_full_size"),c=e.find(".ywcwat_sizeselect").val();"full"==c?(n.parent().hide(),o.show()):(n.parent().show(),o.hide()),_(e);var s=n.parent().width(),h=n.parent().height();switch(i){case"type_img":var m=e.find(".ywcwat_repeat").is(":checked")?"repeat":"no-repeat";n.removeAttr("style"),"repeat"==m?(n.html(""),n.css({background:"url("+l(e)+")",width:"100%",height:"100%","background-repeat":m})):n.html('<img src="'+l(e)+'">');break;case"type_text":n.removeAttr("style");var d,u=r(e),y=ywcwat_premium.gd_version>=2?"pt":"px",f=s*(u.width_box/100),g=h*(u.height_box/100);d=-1==u.line_height?g:u.line_height,n.html("<span>"+u.text_wat+"</span>"),n.css({"font-family":""==u.font_file_name?"inherit":u.font_name,"font-size":u.font_size+y,color:u.color_wat,"background-color":u.background_wat,width:f+"px",height:g+"px","line-height":d+"px"}),n.find("span").css({"-webkit-transform":"rotate(-"+u.angle+"deg )","-moz-transform":"rotate(-"+u.angle+"deg )","-ms-transform":"rotate(-"+u.angle+"deg )","-o-transform":"rotate(-"+u.angle+"deg )",display:"inline-block"})}p(a)},p=function(a){var e=t("#"+w(a)),i=e.find(".position_select"),n=e.find(".ywcwat_text_position"),o=e.find(".ywcwat_preview_bg"),c=o.find(".ywcwat_preview_watermark:eq(0)"),l=c.outerWidth(!0),r=c.outerHeight(!0),_=e.find(".ywcwat_watermark_position:eq(0)"),s=e.find(".ywcwat_margin_x").val(),p=e.find(".ywcwat_margin_y").val(),h=0,m=0,d=0,u=0;i.hasClass("ywcwat_top_left")?(h="calc( 0px + "+p+"px )",m="calc( 0px + "+s+"px )",d="auto",u="auto",_.val("top_left"),n.html(ywcwat_premium.label_position.top_left)):i.hasClass("ywcwat_top_center")?(h="calc( 0px + "+p+"px )",m="calc( 50% - "+l/2+"px + "+s+"px )",d="auto",u="auto",_.val("top_center"),n.html(ywcwat_premium.label_position.top_center)):i.hasClass("ywcwat_top_right")?(h="calc( 0px + "+p+"px )",m="auto",d="calc( 0px + "+s+"px )",u="auto",_.val("top_right"),n.html(ywcwat_premium.label_position.top_right)):i.hasClass("ywcwat_middle_left")?(h="calc( 50% - "+r/2+"px + "+p+"px )",m="calc( 0px + "+s+"px )",d="auto",u="auto",_.val("middle_left"),n.html(ywcwat_premium.label_position.middle_left)):i.hasClass("ywcwat_middle_center")?(h="calc( 50% - "+r/2+"px + "+p+"px )",m="calc( 50% - "+l/2+"px + "+s+"px )",d="auto",u="auto",_.val("middle_center"),n.html(ywcwat_premium.label_position.middle_center)):i.hasClass("ywcwat_middle_right")?(h="calc( 50% - "+r/2+"px + "+p+"px )",m="auto",d="calc( 0px + "+s+"px )",u="auto",_.val("middle_right"),n.html(ywcwat_premium.label_position.middle_right)):i.hasClass("ywcwat_bottom_left")?(h="auto",m="calc( 0px + "+s+"px )",d="auto",u="calc( 0px + "+p+"px )",_.val("bottom_left"),n.html(ywcwat_premium.label_position.bottom_left)):i.hasClass("ywcwat_bottom_center")?(h="auto",m="calc( 50% - "+l/2+"px )",d="auto",u="calc( 0px + "+p+"px )",_.val("bottom_center"),n.html(ywcwat_premium.label_position.bottom_center)):(h="auto",m="auto",d="calc( 0px + "+s+"px )",u="calc( 0px + "+p+"px )",_.val("bottom_right"),n.html(ywcwat_premium.label_position.bottom_right)),c.css({top:h,bottom:u,left:m,right:d}),t("body").trigger("ywcwat_compute_position")},h=function(){t(".ywcwat_select_type_wat").on("change",function(a){var e=t(this),i=e.val(),n=t("#"+w(e)),o=n.find(".ywcwat_text_field_container"),c=n.find(".ywcwat_img_field_container"),l=n.find(".ywcwat_general_field_container"),r=n.find(".position_select");switch(i){case"type_text":c.hide(),o.show(),l.show();break;case"type_img":c.show(),o.hide(),l.show();break;case"no":c.hide(),o.hide(),l.hide()}s(r)}).change(),t(document).on("click",".ywcwat_add_watermark",function(e){e.preventDefault();var l=t(this),r=t("#"+w(l));if(i=r.find(".ywcwat_url"),n=r.find('input:hidden[id^="ywcwat_watermark_id-"]'),o=r.find(".ywcwat_preview_watermark img"),c=r.find(".ywcwat_bottom_right"),a)return void a.open();var _=[new wp.media.controller.Library({library:wp.media.query({type:"image"}),multiple:!1,title:l.data("choose"),priority:20,filterable:"all"})];a=wp.media.frames.downloadable_file=wp.media({title:l.data("choose"),library:{type:"image"},button:{text:l.data("choose")},multiple:!1,states:_}),a.on("select",function(){var t=a.state().get("selection");t.map(function(t){t=t.toJSON(),t.url&&(n.val(t.id),o.attr("src",t.url),i.val(t.url),c.click(),s(l))})}),a.open()})},m=function(t){return parseInt(y(t).substring(0,2),16)},d=function(t){return parseInt(y(t).substring(2,4),16)},u=function(t){return parseInt(y(t).substring(4,6),16)},y=function(t){return"#"==t.charAt(0)?t.substring(1,7):t};t(document).on("click",".ywcwat_remove_watermark",function(a){a.preventDefault();var e=t(this),i=e.data("element_id"),n=window.confirm(ywcwat_premium.delete_single_watermark.confirm_delete_watermark);return n&&(t("#ywcwat_row-"+i).remove(),h()),!1}),t(document).on("click",".ywcwat_container_position tr td",function(a){var e=t(this),i=e.parent().parent();i.find("td").removeClass("position_select"),e.addClass("position_select"),s(e)}),t(document).on("change",".ywcwat_margin_x, .ywcwat_margin_y, .ywcwat_text_angle,.ywcwat_repeat",function(){var a=t(this);s(a)}),t(document).on("change",".ywcwat_line_height",function(a){var e=t(this);s(e)}),t(document).on("change paste keyup input focus",".ywcwat_text_wat",function(){var a=t(this);s(a)}),t(document).on("change",".ywcwat_font_size,.ywcwat_box_width,.ywcwat_box_height,.ywcwat_opacity,.ywcwat_watermark_font,.ywcwat_watermark_padding",function(){var a=t(this);s(a)}),t(document).on("change",".ywcwat_sizeselect",function(){s(t(this))}).change(),t(document).on("init_color_picker",function(){t(".ywcwat_color_picker").wpColorPicker({change:function(a,e){s(t(this))}})}).trigger("init_color_picker"),t(".iris-palette").on("click",function(){setTimeout(s(t(this),1))}),t("body").on("initial_position_watermark",function(){h()}),h()});